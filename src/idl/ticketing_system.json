{"version":"0.1.0","name":"ticketing_system","instructions":[{"name":"registerUser","accounts":[{"name":"authority","isMut":false,"isSigner":false},{"name":"payer","isMut":true,"isSigner":true},{"name":"userProfile","isMut":true,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false}],"args":[{"name":"dataHash","type":{"array":["u8",32]}}]},{"name":"initialize","accounts":[{"name":"authority","isMut":true,"isSigner":true},{"name":"globalConfig","isMut":true,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false}],"args":[{"name":"authority","type":"publicKey"},{"name":"tfyTokenMint","type":"publicKey"}]},{"name":"togglePause","accounts":[{"name":"globalConfig","isMut":true,"isSigner":false},{"name":"authority","isMut":false,"isSigner":true}],"args":[{"name":"paused","type":"bool"}]},{"name":"createBuyerCounter","accounts":[{"name":"payer","isMut":true,"isSigner":true},{"name":"event","isMut":false,"isSigner":false},{"name":"buyer","isMut":false,"isSigner":false},{"name":"buyerTicketCount","isMut":true,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false}],"args":[]},{"name":"manageWhitelist","accounts":[{"name":"globalConfig","isMut":false,"isSigner":false},{"name":"authority","isMut":true,"isSigner":true},{"name":"whitelist","isMut":true,"isSigner":false},{"name":"wallet","isMut":false,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false}],"args":[{"name":"walletAddress","type":"publicKey"},{"name":"isWhitelisted","type":"bool"},{"name":"platformFeeBps","type":"u16"}]},{"name":"updateRoyalty","accounts":[{"name":"globalConfig","isMut":false,"isSigner":false},{"name":"authority","isMut":true,"isSigner":true},{"name":"whitelist","isMut":true,"isSigner":false},{"name":"wallet","isMut":false,"isSigner":false}],"args":[{"name":"walletAddress","type":"publicKey"},{"name":"newPlatformFeeBps","type":"u16"}]},{"name":"updateEventDetails","accounts":[{"name":"event","isMut":true,"isSigner":false},{"name":"controller","isMut":false,"isSigner":true}],"args":[{"name":"metadataUri","type":{"option":"string"}},{"name":"resaleAllowed","type":{"option":"bool"}},{"name":"royaltyBps","type":{"option":"u16"}},{"name":"transferFeeBps","type":{"option":"u16"}},{"name":"maxTicketsPerWallet","type":{"option":"u8"}}]},{"name":"createEvent","accounts":[{"name":"whitelistAccount","isMut":false,"isSigner":false},{"name":"eventAccount","isMut":true,"isSigner":false},{"name":"controller","isMut":true,"isSigner":true},{"name":"payer","isMut":true,"isSigner":true},{"name":"collectionMint","isMut":true,"isSigner":false},{"name":"collectionTokenAccount","isMut":true,"isSigner":false},{"name":"collectionMetadata","isMut":true,"isSigner":false},{"name":"collectionEdition","isMut":true,"isSigner":false},{"name":"metadataProgram","isMut":false,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false},{"name":"associatedTokenProgram","isMut":false,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false},{"name":"rent","isMut":false,"isSigner":false}],"args":[{"name":"eventId","type":"u64"},{"name":"metadataUri","type":"string"},{"name":"treasury","type":"publicKey"},{"name":"transferFeeBps","type":"u16"},{"name":"resaleAllowed","type":"bool"},{"name":"maxTicketsPerWallet","type":"u8"},{"name":"tiers","type":{"vec":{"defined":"TicketTier"}}},{"name":"collectionName","type":"string"},{"name":"collectionSymbol","type":"string"}]},{"name":"addTicketTier","accounts":[{"name":"event","isMut":true,"isSigner":false},{"name":"controller","isMut":false,"isSigner":true}],"args":[{"name":"tierInput","type":{"defined":"TicketTier"}}]},{"name":"addValidator","accounts":[{"name":"event","isMut":true,"isSigner":false},{"name":"controller","isMut":false,"isSigner":true}],"args":[{"name":"validator","type":"publicKey"}]},{"name":"activateEvent","accounts":[{"name":"event","isMut":true,"isSigner":false},{"name":"controller","isMut":false,"isSigner":true}],"args":[]},{"name":"finishEvent","accounts":[{"name":"event","isMut":true,"isSigner":false},{"name":"controller","isMut":false,"isSigner":true}],"args":[]},{"name":"removeValidator","accounts":[{"name":"event","isMut":true,"isSigner":false},{"name":"controller","isMut":false,"isSigner":true}],"args":[{"name":"validator","type":"publicKey"}]},{"name":"cancelEvent","accounts":[{"name":"event","isMut":true,"isSigner":false},{"name":"controller","isMut":false,"isSigner":true}],"args":[]},{"name":"mintTicket","accounts":[{"name":"globalConfig","isMut":false,"isSigner":false},{"name":"event","isMut":true,"isSigner":false},{"name":"payer","isMut":true,"isSigner":true},{"name":"buyer","isMut":false,"isSigner":false},{"name":"ticket","isMut":true,"isSigner":false},{"name":"buyerTicketCount","isMut":true,"isSigner":false},{"name":"mintAccount","isMut":true,"isSigner":true},{"name":"associatedTokenAccount","isMut":true,"isSigner":false},{"name":"metadataAccount","isMut":true,"isSigner":false},{"name":"collectionMint","isMut":true,"isSigner":false},{"name":"collectionMetadata","isMut":true,"isSigner":false},{"name":"collectionEdition","isMut":false,"isSigner":false},{"name":"metadataProgram","isMut":false,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false},{"name":"associatedTokenProgram","isMut":false,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false},{"name":"rent","isMut":false,"isSigner":false}],"args":[{"name":"tierIndex","type":"u8"},{"name":"nftMetadataUri","type":"string"},{"name":"nftName","type":"string"},{"name":"nftSymbol","type":"string"}]},{"name":"listForSale","accounts":[{"name":"seller","isMut":true,"isSigner":true},{"name":"event","isMut":false,"isSigner":false},{"name":"ticket","isMut":false,"isSigner":false},{"name":"nftMint","isMut":false,"isSigner":false},{"name":"sellerTokenAccount","isMut":true,"isSigner":false},{"name":"listing","isMut":true,"isSigner":false},{"name":"escrowAccount","isMut":false,"isSigner":false},{"name":"escrowTokenAccount","isMut":true,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false},{"name":"associatedTokenProgram","isMut":false,"isSigner":false}],"args":[{"name":"price","type":"u64"}]},{"name":"cancelListing","accounts":[{"name":"seller","isMut":true,"isSigner":true},{"name":"listing","isMut":true,"isSigner":false},{"name":"ticket","isMut":false,"isSigner":false},{"name":"nftMint","isMut":false,"isSigner":false},{"name":"escrowAccount","isMut":true,"isSigner":false},{"name":"sellerTokenAccount","isMut":true,"isSigner":false},{"name":"escrowTokenAccount","isMut":true,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false},{"name":"associatedTokenProgram","isMut":false,"isSigner":false}],"args":[]},{"name":"updateTicketTier","accounts":[{"name":"event","isMut":true,"isSigner":false},{"name":"controller","isMut":false,"isSigner":true}],"args":[{"name":"tierIndex","type":"u8"},{"name":"name","type":{"option":"string"}},{"name":"priceBrlCents","type":{"option":"u64"}},{"name":"maxTicketsSupply","type":{"option":"u32"}},{"name":"activationLogic","type":{"option":{"defined":"SaleActivationLogic"}}},{"name":"salesEndDate","type":{"option":"i64"}},{"name":"minPerPurchase","type":{"option":"u8"}},{"name":"maxPerPurchase","type":{"option":"u8"}},{"name":"isTransferable","type":{"option":"bool"}}]},{"name":"buyFromMarketplace","accounts":[{"name":"buyer","isMut":true,"isSigner":true},{"name":"listing","isMut":true,"isSigner":false},{"name":"seller","isMut":true,"isSigner":false},{"name":"buyerTokenAccountTfy","isMut":true,"isSigner":false},{"name":"sellerTokenAccountTfy","isMut":true,"isSigner":false},{"name":"eventControllerTokenAccountTfy","isMut":true,"isSigner":false},{"name":"ticket","isMut":true,"isSigner":false},{"name":"nftMint","isMut":false,"isSigner":false},{"name":"escrowAccount","isMut":true,"isSigner":false},{"name":"escrowTokenAccount","isMut":true,"isSigner":false},{"name":"buyerTokenAccount","isMut":true,"isSigner":false},{"name":"globalConfig","isMut":false,"isSigner":false},{"name":"event","isMut":false,"isSigner":false},{"name":"systemProgram","isMut":false,"isSigner":false},{"name":"tokenProgram","isMut":false,"isSigner":false},{"name":"associatedTokenProgram","isMut":false,"isSigner":false}],"args":[]},{"name":"redeemTicket","accounts":[{"name":"ticket","isMut":true,"isSigner":false},{"name":"event","isMut":false,"isSigner":false},{"name":"validator","isMut":false,"isSigner":true},{"name":"owner","isMut":false,"isSigner":false},{"name":"nftToken","isMut":false,"isSigner":false},{"name":"nftMint","isMut":false,"isSigner":false}],"args":[]}],"accounts":[{"name":"BuyerTicketCount","type":{"kind":"struct","fields":[{"name":"event","type":"publicKey"},{"name":"buyer","type":"publicKey"},{"name":"count","type":"u8"}]}},{"name":"Event","type":{"kind":"struct","fields":[{"name":"eventId","type":"u64"},{"name":"controller","type":"publicKey"},{"name":"state","type":{"defined":"EventState"}},{"name":"transferFeeBps","type":"u16"},{"name":"royaltyBps","type":"u16"},{"name":"maxTicketsPerWallet","type":"u8"},{"name":"resaleAllowed","type":"bool"},{"name":"tiers","type":{"vec":{"defined":"TicketTier"}}},{"name":"metadataUri","type":"string"},{"name":"treasury","type":"publicKey"},{"name":"validators","type":{"vec":"publicKey"}},{"name":"bump","type":"u8"},{"name":"collectionMint","type":"publicKey"},{"name":"collectionMetadata","type":"publicKey"},{"name":"collectionEdition","type":"publicKey"}]}},{"name":"GlobalConfig","type":{"kind":"struct","fields":[{"name":"authority","type":"publicKey"},{"name":"paused","type":"bool"},{"name":"tfyTokenMint","type":"publicKey"},{"name":"defaultPlatformFeeBps","type":"u16"}]}},{"name":"MarketplaceListing","type":{"kind":"struct","fields":[{"name":"seller","type":"publicKey"},{"name":"nftMint","type":"publicKey"},{"name":"price","type":"u64"},{"name":"escrowAccount","type":"publicKey"}]}},{"name":"Ticket","type":{"kind":"struct","fields":[{"name":"event","type":"publicKey"},{"name":"nftMint","type":"publicKey"},{"name":"owner","type":"publicKey"},{"name":"redeemed","type":"bool"},{"name":"redeemedBy","type":"publicKey"},{"name":"redeemedAt","type":"i64"},{"name":"pricePaidBrlCents","type":"u64"}]}},{"name":"UserProfile","type":{"kind":"struct","fields":[{"name":"authority","type":"publicKey"},{"name":"dataHash","type":{"array":["u8",32]}}]}},{"name":"Whitelist","type":{"kind":"struct","fields":[{"name":"wallet","type":"publicKey"},{"name":"isWhitelisted","type":"bool"},{"name":"platformFeeBps","type":"u16"}]}}],"types":[{"name":"TicketTier","type":{"kind":"struct","fields":[{"name":"name","type":"string"},{"name":"priceBrlCents","type":"u64"},{"name":"maxTicketsSupply","type":"u32"},{"name":"ticketsSold","type":"u32"},{"name":"activationLogic","type":{"defined":"SaleActivationLogic"}},{"name":"salesEndDate","type":"i64"},{"name":"minPerPurchase","type":"u8"},{"name":"maxPerPurchase","type":"u8"},{"name":"isTransferable","type":"bool"}]}},{"name":"EventState","type":{"kind":"enum","variants":[{"name":"Draft"},{"name":"Active"},{"name":"Finished"},{"name":"Canceled"}]}},{"name":"SaleActivationLogic","type":{"kind":"enum","variants":[{"name":"OnDate","fields":[{"name":"startDate","type":"i64"}]},{"name":"AfterTier","fields":[{"name":"watchedTierIndex","type":"u8"}]}]}}],"events":[{"name":"TicketSold","fields":[{"name":"listingKey","type":"publicKey","index":false},{"name":"seller","type":"publicKey","index":false},{"name":"buyer","type":"publicKey","index":false},{"name":"nftMint","type":"publicKey","index":false},{"name":"price","type":"u64","index":false}]},{"name":"EventCanceled","fields":[{"name":"eventKey","type":"publicKey","index":false},{"name":"controller","type":"publicKey","index":false}]},{"name":"ListingCanceled","fields":[{"name":"listingKey","type":"publicKey","index":false},{"name":"nftMint","type":"publicKey","index":false},{"name":"seller","type":"publicKey","index":false}]},{"name":"EventCreated","fields":[{"name":"eventKey","type":"publicKey","index":false},{"name":"eventId","type":"u64","index":false},{"name":"controller","type":"publicKey","index":false},{"name":"metadataUri","type":"string","index":false},{"name":"collectionMint","type":"publicKey","index":false}]},{"name":"ItemListed","fields":[{"name":"listingKey","type":"publicKey","index":false},{"name":"seller","type":"publicKey","index":false},{"name":"nftMint","type":"publicKey","index":false},{"name":"price","type":"u64","index":false}]},{"name":"TicketRedeemed","fields":[{"name":"ticketPda","type":"publicKey","index":false},{"name":"event","type":"publicKey","index":false},{"name":"redeemedBy","type":"publicKey","index":false},{"name":"owner","type":"publicKey","index":false}]}],"errors":[{"code":6000,"name":"StringTooLong","msg":"String too long for field"},{"code":6001,"name":"InvalidDate","msg":"Invalid date or dates out of order"},{"code":6002,"name":"InvalidController","msg":"Invalid event controller"},{"code":6003,"name":"ControllerNotWhitelisted","msg":"Event creator wallet is not whitelisted"},{"code":6004,"name":"InvalidAuthority","msg":"Invalid authority"},{"code":6005,"name":"InvalidOwner","msg":"Invalid ticket owner"},{"code":6006,"name":"InvalidSeller","msg":"Invalid seller for this listing"},{"code":6007,"name":"EventNotActive","msg":"Event must be active to perform this action."},{"code":6008,"name":"EventFinishedOrCancelled","msg":"Event is finished or cancelled and cannot be modified."},{"code":6009,"name":"SupplyCannotBeLessThanSold","msg":"The new supply cannot be less than the number of tickets already sold."},{"code":6010,"name":"EventNotDraft","msg":"Action only allowed when event is in Draft mode"},{"code":6011,"name":"EventAlreadyCanceled","msg":"Event already canceled"},{"code":6012,"name":"EventNotCanceled","msg":"Event is not canceled (required for this action)"},{"code":6013,"name":"EventFinished","msg":"Event already finished"},{"code":6014,"name":"EventSalesPeriodOver","msg":"Event sales period has ended"},{"code":6015,"name":"EventSalesNotOver","msg":"Event sales period has not ended yet"},{"code":6016,"name":"EventMismatch","msg":"Ticket does not belong to this event"},{"code":6017,"name":"NoTiersProvided","msg":"No tiers provided for event creation"},{"code":6018,"name":"MaxTiersReached","msg":"Maximum tier limit (10) reached"},{"code":6019,"name":"TierNotFound","msg":"Tier not found - invalid index provided"},{"code":6020,"name":"FirstTierCannotBeChained","msg":"First tier cannot be of type 'AfterTier'"},{"code":6021,"name":"TierCannotWatchItself","msg":"Tier cannot watch itself for sales activation"},{"code":6022,"name":"InvalidWatchedTierIndex","msg":"Invalid watched tier index"},{"code":6023,"name":"CannotUpdateTierWithSoldTickets","msg":"Cannot update tier with sold tickets"},{"code":6024,"name":"InvalidTierIndex","msg":"Invalid ticket tier index"},{"code":6025,"name":"TierNotYetActive","msg":"Sales for this tier have not started yet"},{"code":6026,"name":"TierSalesEnded","msg":"Sales for this tier have ended"},{"code":6027,"name":"SoldOut","msg":"Tickets for this tier are sold out"},{"code":6028,"name":"TicketsSoldMustBeZero","msg":"Ticket count must be initialized as zero"},{"code":6029,"name":"MaxTicketsPerWalletExceeded","msg":"Max tickets per wallet exceeded for this event"},{"code":6030,"name":"ResaleNotAllowed","msg":"Ticket resale not allowed for this event"},{"code":6031,"name":"AlreadyRedeemed","msg":"Ticket already redeemed"},{"code":6032,"name":"InvalidValidator","msg":"Validator not registered for this event"},{"code":6033,"name":"MaxValidatorsReached","msg":"Maximum validators limit reached"},{"code":6034,"name":"InvalidTicketMint","msg":"Invalid ticket NFT mint"},{"code":6035,"name":"NotWhitelisted","msg":"Wallet is not whitelisted"}]}